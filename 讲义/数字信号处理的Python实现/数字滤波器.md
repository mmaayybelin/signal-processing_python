## 数字滤波器

### 数字滤波器的结构

#### 1 无限长单位脉冲响应数字滤波器的结构

##### 直接型IIR滤波器

直接型IIR滤波器包括直接I型（直接型）和直接II型（典范型）。

**1 直接I型**

①滤波器原理

IIR滤波器的系统函数

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image304.png)  | (4-3-57) |
|---|---|----------|

对应的差分方程为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image305.png)  | (4-3-58) |
|---|---|----------|

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image306.png)由两部分相加构成：第一部分![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image307.png)是一个对输入![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image125.png)的M节延时链结构，每节延时抽头后加权相加；第二部分![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image308.png)是一个对![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image309.png)的延时链结构，每级延时抽头后加权相加，因此是一个反馈网络。这种结构型式称为直接I型，如图4.3.6所示。为了方便，图中画的是M=N的情况，若![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image310.png)，N阶滤波器需要![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image311.png)级延时单元。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image312.jpg)![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image313.png)

图 4.3.6 直接I型结构方框图和结构流图

(a)结构方框图；(b)结构流图

②Python实现案例

用直接Ⅰ型实现系统函数如下的IIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image314.png) | (4-3-59) |
|---|---|----------|

[直接Ⅰ型IIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E7%9B%B4%E6%8E%A5%E2%85%A0%E5%9E%8B.ipynb)

③用到的Python函数：

1.unit_impulse：unit impulse signal (discrete delta function) or unit basis vector.

函数用法：y = scipy.signal.unit_impulse(shape, idx=None, dtype=\<class 'float'\>)

输入参数：shape是采样点数（int型或tuple型）；idx是单位采样信号出现的点，默认为0；dtype指定数组中元素类型。

输出参数：y返回单位采样信号。

2.lfilter_zi：construct initial conditions for lfilter for step response steady-state.

函数用法：zi = scipy.signal.lfilter_zi(b, a)

输入参数：b是滤波器的分子系数；a是滤波器的分母系数（若a[0]不为1，则会将分子分母用a[0]进行归一化）。

输出参数：zi返回滤波器的初始值；若为零初始条件，则将值全部赋为零。

3.lfilter：filter data along one-dimension with an IIR or FIR filter.

函数用法：y,zf = scipy.signal.lfilter(b, a, x, axis= -1, zi=None)

输入参数：b是滤波器的分子系数；a是滤波器的分母系数；x是要经过滤波器的信号；axis是滤波器要处理的输入信号的坐标轴（维度），默认为-1；zi是初始条件。

输出参数：y是数字滤波器的输出值；zf保存最终的滤波器延迟值。

**2 直接II型**

①滤波器原理

将IIR滤波器的系统函数改写成下式（当M=N的情况）

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image315.png) | (4-3-60) |
|---|---|----------|

因此H(z)可视为分子多项式![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image316.png)与分母多项式![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image317.png)的倒数所构成的两个子系统函数的乘积，这相应于两子系统的级联。其中第一子系统实现零点为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image318.png) | (4-3-61) |
|---|---|----------|

故得

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image319.png)  | (4-3-62) |
|---|---|----------|

其时域表示为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image320.png) | (4-3-63) |
|---|---|----------|

第二子系统实现极点为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image321.png)  | (4-3-64) |
|---|---|----------|

经整理后得

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image322.png) | (4-3-65) |
|---|---|----------|

其时域表示为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image323.png)  | (4-3-66) |
|---|---|----------|

综上所述，可得图4.3.8的实现结构。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image324.jpg)
![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image325.png)

图 4.3.8 直接Ⅱ型的结构方框图和结构流图

结构方框图；结构流图

②Python实现案例

用直接Ⅱ型实现系统函数如下的IIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image314.png)  | (4-3-67) |
|---|---|----------|

[直接Ⅱ型IIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E7%9B%B4%E6%8E%A5%E2%85%A1%E5%9E%8B.ipynb)

##### 级联型IIR滤波器

①滤波器原理

IIR滤波器的系统函数按零点和极点进行因式分解，则可表示成

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image326.png) | (4-3-68) |
|---|---|----------|

式中A为归一化常数。由于系统函数H(z)的系数都是实系数，故零、极点![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image327.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image328.png)只有两种情况：或者是实根，或者是共轭复根，即

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image329.png) | (4-3-69) |
|---|---|----------|

式中![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image330.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image331.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image332.png)表示实零点，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image333.png)表示实极点，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image334.png)和![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image335.png)表示复共轭零点，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image336.png)和![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image337.png)表示复共轭极点。每一对共轭因子合并起来，就可以构成一个实系数的二阶因子。因此

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image338.png)  | (4-3-70) |
|---|---|----------|

上式给出了任意系统均可由一阶和二阶子系统级联构成表达式。如果我们假设实数极点和实数零点已成对合并，井把单实根因子看作二阶因子的特例，即二次项系数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image339.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image340.png)等于零的二阶因子，同时假设![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image341.png)，则整个函数H(z)可分解为实系数二项因子的形式。

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image342.png) | (4-3-71) |
|---|---|----------|

其中![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image343.png)，L表示![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image344.png)中最大整数。![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image345.png)称为滤波器的二阶基本节，可以采用直接Ⅱ型结构实现，整个滤波器则是![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image345.png)的级联。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image346.jpg)

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image347.png)

图 4.3.10 直接II型级联结构的二阶基本节方框图和流图

(a)基本节方框图；(b)基本节流图

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image348.jpg)

图 4.3.11 级联结构型式

②Python实现案例

用级联结构实现如下系统函数的IIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image349.png)  | (4-3-72) |
|---|---|----------|

[级联型IIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E7%BA%A7%E8%81%94%E5%9E%8B.ipynb)

##### 并联型IIR滤波器

①滤波器原理

将IIR滤波器的系统函数H(z)展成部分分式之和

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image350.png)

(4-3-73)

式中![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image351.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image352.png)是![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image328.png)的共轭复数。由于(4-3-57)中系数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image353.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image354.png)是实数，故![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image185.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image355.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image356.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image357.png)及![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image358.png)全是实数。如果M<N,则(4-3-73)式中不包含![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image359.png)项，如果M>N，则![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image359.png)项变为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image360.png)。一般IIR系统皆满足M≤N的条件。当M=N时，(4-3-73)式成为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image361.png) | (4-3-74) |
|---|---|----------|

总系统函数为各部分系统函数之和时，则表示总系统为各相应子系统的并联。因此，(4-3-74)式可以解释为一阶和二阶系统的并联组合，其结构实现如图4.3.13(a)所示。每个一阶或二阶子系统可用直接型II实现，如图4.3.13(b),(c)所示。也可将(4-3-74)式中实根部分两两合并，形成二阶分式，以便系统全部采用二阶系统结构。

|  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image362.jpg)(a) | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image363.jpg) (b) |
|---|---|
|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image364.jpg)(c) |

图 4.3.13 并联型结构方框图和基本节方框图

(a)结构方框图；(c)一阶基本节方框图；

(c)二阶基本节方框图

| ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image365.png)  |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image366.png) |
|---|---|
|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image367.png) |

图 4.3.14 并联型结构流图和基本节流图

(a)结构流图；(b)一阶基本节流图；

(c)二阶基本节流图

②Python实现案例

用并联结构实现如下系统函数的IIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image368.png)  | (4-3-75) |
|---|---|----------|

[并联型IIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E5%B9%B6%E8%81%94%E5%9E%8B.ipynb)

#### 2 有限长单位脉冲响应数字滤波器的结构

##### 直接型FIR滤波器

①滤波器原理

有限长单位脉冲响应滤波器的系统函数为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image369.png) | (4-3-76) |
|---|---|----------|

其差分方程为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image370.png)  | (4-3-77) |
|---|---|----------|

由上式可得出图4.3.16所示的直接型结构，也称为为抽头延迟线滤波器，或横向滤波器。FIR滤波器也可看成是IIR滤波器在各![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image371.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image372.png)时的特例。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image373.jpg)
(a)
![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image374.png)
(b)

图 4.3.16 FIR滤波器直接型结构框图和流图

(a)结构框图；(b)流图

②Python实现案例

用直接型结构实现如下系统函数的FIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image375.png)  | (4-3-78) |
|---|---|----------|

[直接型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%9B%B4%E6%8E%A5%E5%9E%8B.ipynb)

##### 级联型FIR滤波器

①滤波器原理

将FIR滤波器的系统函数分解成若干一阶和二阶多项式的连乘积

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image376.png)  | (4-3-79) |
|---|---|----------|

其中，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image377.png)为一阶节；![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image378.png)为二阶节。级联型结构如图4.3.18所示。这种结构的每一节都便于控制零点，在需要控制传输零点时可以采用。但是它所需要的系数a比直接型![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image071.png)的多，所需要的乘法运算也比直接型多。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image379.jpg)

图 4.3.18 FIR级联型结构方框图

②Python实现案例

用级联型结构实现如下系统函数的FIR数字滤波器，并求单位脉冲响应和单位阶跃响应。

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image380.png) | (4-3-80) |
|---|---|----------|

[级联型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%BA%A7%E8%81%94%E5%9E%8B.ipynb)

##### 线性相位型FIR滤波器

①滤波器原理

线性相位特性是指滤波器对不同频率的正弦波所产生的相移和正弦波的频率成直线关系，有两类严格的线性相位函数

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image381.png)  | (4-3-81) |
|---|---|----------|
|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image382.png) | (4-3-82) |

其中，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image383.png)都是常数，这两类线性相位函数的群时延都是常数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image384.png)。

因此，在滤波器通带内的信号通过滤波器后，除了由相频特性的斜率决定的延迟外，可以不失真地保留通带以内的全部信号。

②滤波器结构

线性相位的因果的FIR系统的单位取样响应具有如下特性

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image385.png)  | (4-3-83) |
|---|---|----------|

此时FIR滤波器的系统函数可分两种情况写出：

·当N为偶数时

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image386.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image387.png) | (4-3-84) |
|---|---|----------|

利用(4-3-83)式可得到

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image388.png)  | (4-3-85) |
|---|---|----------|

·当N为奇数时，易于证明

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image389.png)  | (4-3-86) |
|---|---|----------|

(4-3-85)式及(4-3-86)式的FIR系统的非递归型实现结构如图4.3.20所示，当![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image390.png)为偶对称时，图中的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image391.png)取![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image392.png)；为奇对称时取![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image393.png)。由图可见，该结构仅需![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image394.png)（N为偶数时）个或![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image395.png)（N为奇数时）个乘法运算，而不是N次乘法。

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image396.jpg)

图 4.3.20 线性相位FIR滤波器的直接型结构方框图

(a)偶数阶；(b)奇数阶

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image397.png)(a)
![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image398.png)(b)

图 4.3.21 线性相位FIR滤波器的直接型结构流图

(a)N为奇数；(b)N为偶数

四种线性相位FIR滤波器的特性如下表所示

表4.3.2 四种线性相位FIR滤波器特性

| 偶对称单位脉冲响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image399.png)  |       |            |      |          使用范围               |
|---------------------|----------------|------------|------|------------------------|
| 情  况  1           |     相位响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image400.png)    | *N*为奇数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image402.jpg)  |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image403.png)![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image404.jpg) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image405.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image406.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image407.png)     | 低通、高通、带通、带阻 |
| 情  况  2           |       ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image401.jpg)         | N为偶数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image408.jpg)    |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image409.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image410.jpg) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image411.png)  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image412.png)   | 低通、带通             |

| 奇对称单位脉冲响应  |     |    ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image413.png)        |     |                 使用范围                    |
|---------------------|--------------|------------|-----|------------------------------------|
| 情  况  3           |   相位响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image414.png)  | *N*为奇数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image416.jpg) | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image417.png)   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image418.jpg) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image419.png)![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image407.png)| 带通、微分器、希尔伯特变换器       |
| 情  况  4           |      ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image415.jpg)        | *N*为偶数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image420.jpg) |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image421.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image422.jpg)![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image423.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image407.png) | 高通、带通、微分器、希尔伯特变换器 |

③Python实现案例

例1：画出单位脉冲响应为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image424.png)的第Ⅰ型线性相位滤波器的幅度函数和相位函数。

[第Ⅰ类线性相位型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%BA%BF%E6%80%A7%E7%9B%B8%E4%BD%8D%E5%9E%8B%E2%85%A0.ipynb)

例2：画出单位脉冲响应为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image425.png)的第Ⅱ型线性相位滤波器的幅度函数和相位函数。

[第Ⅱ类线性相位型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%BA%BF%E6%80%A7%E7%9B%B8%E4%BD%8D%E5%9E%8B%E2%85%A1.ipynb)

例3：画出单位脉冲响应为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image426.png)的第Ⅲ型线性相位滤波器的幅度函数和相位函数。

[第Ⅲ类线性相位型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%BA%BF%E6%80%A7%E7%9B%B8%E4%BD%8D%E2%85%A2.ipynb)

例4：画出单位脉冲响应为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image426.png)的第Ⅳ型线性相位滤波器的幅度函数和相位函数。

[第Ⅳ类线性相位型FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E7%BA%BF%E6%80%A7%E7%9B%B8%E4%BD%8D%E2%85%A3.ipynb)

### IIR数字滤波器设计

#### 1模拟原型滤波器

##### 巴特沃斯滤波器

①滤波器原理

巴特沃斯滤波器在通带中有最大平坦的振幅特性，即N阶低通滤波器在 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image427.png)处幅度平方函数的前 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image428.png)阶导数等于零，在止带内的逼近是单调变化的。其幅度平方函数的形式是

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image429.png)  | (4-3-87) |
|---|---|----------|

式中N为整数，是滤波器的阶次。 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image430.png)定义为截止频率，当 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image431.png)时， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image432.png)或 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image433.png)，这相当3.01dB的衰减，所以 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image434.png)又称为3dB带宽。

巴特沃斯滤波器的特性完全由其阶数N决定，当N增大时，滤波器的特性曲线将在通带的更大范围内接近于1，在止带内更迅速地接近于零，因而振幅特性更接近于理想的矩形频率特性。其频率特性曲线，无论在通带和阻带中都是频率的单调函数。因此，当通带的边界处满足指标要求时，通带内肯定会有裕量。

②Python实现案例

设计一个巴特沃斯低通滤波器，其通带截止频率 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image435.png)，通带最大衰减 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image436.png)，阻带截止频率 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image437.png)，阻带最小衰减 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image438.png)。

[巴特沃斯滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E5%B7%B4%E7%89%B9%E6%B2%83%E6%96%AF%E6%BB%A4%E6%B3%A2%E5%99%A8.ipynb)

##### 切比雪夫滤波器

切比雪夫滤波器的振幅特性具有等波纹特性。它通过选择具有等波纹特性的逼近函数，将精确度均匀地分布在整个通带或阻带内，或者同时分布在两者之内，这样就可用阶数较低的系统满足要求。

切比雪夫滤波器有两种型式：振幅特性在通带内是等波纹的，在阻带内是单调的称为切比雪夫I型滤波器；振幅特性在通带内是单调的，在阻带内是等波纹的称为切比雪夫Ⅱ型滤波器。采用何种型式切比雪夫滤波器取决于实际用途。图4.3.27，图4.3.28分别画出了阶次为奇数与偶数时的切比雪夫I、Ⅱ型滤波器的频率特性。

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image439.jpg)

    (a)            (b)

图 4.3.27 切比雪夫I型滤波器的频率特性

(a)N为奇数；(b)N为偶数

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image440.jpg)

     (a)            (b)

图 4.3.28 切比雪夫II型滤波器的频率特性

(a)N为奇数；(b)N为偶数

切比雪夫I型滤波器的幅度平方函数为

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image441.png) | (4-3-88) |
|---|---|----------|

其中 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image442.png)为小于1的正数，表示通带内振幅波动的程度， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image442.png)愈大，波动也愈大； ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image443.png)为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image444.png)对 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image445.png)频率的归一化频率， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image445.png)为截止频率，也是滤波器的通带宽度； ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image446.png)是N阶切比雪夫多项式。由此可见，确定切比雪夫滤波器特性有三个参数： ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image447.png)及N，只要确定了这三个参数，滤波器设计就完成了。

②Python实现案例

设计一个低通切比雪夫I型滤波器，其通带截止频率 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image435.png)，通带最大衰减 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image436.png)，阻带截止频率 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image437.png)，阻带最小衰减 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image438.png)。

[切比雪夫Ⅰ型滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E6%BB%A4%E6%B3%A2%E5%99%A8.ipynb)

#### 2从模拟滤波器到数字滤波器的变换

从模拟滤波器设计IIR数字滤波器就是要由列出的 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image448.png)进一步求得 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)。归根结底是一个由 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image449.png)平面到z平面的变换，这个变换应遵循两个基本的目标：

① ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)的频响必须要模仿 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image448.png)的频响，也即s平面的虚轴 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image450.png)应该映射到平面的单位圆上。

② ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image448.png)的因果稳定性，通过映射后仍应在所得到的 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)中保持，也即s平面的左半平面 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image451.png)应该映射到z平面单位圆以内 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image452.png)。

IIR滤波器经常采用借助于模拟滤波器的设计方法来进行，设计方法有脉冲响应不变变换法和双线性变换法。

##### 脉冲响应不变变换法

①变换原理

脉冲响应不变变换法又称为标准z变换法。它是保证从模拟滤波器变换得到的数字滤波器的单位取样响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image453.png),是相应的模拟滤波器的单位脉冲响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image454.png)的等间隔取样值，即

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image455.png)  | (4-3-3) |
|---|---|---------|

②变换过程

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image454.png)的拉氏变换为

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image456.png) | (4-3-4) |
|---|---|---------|

现实的系统通常是分母的阶数N，高于分子的阶数M,这时系统若只有单极点(若不是单极点情况，则求逆拉氏变换要复杂一些)，则可将模拟滤波器的系统函数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image459.png)表达为如下的部分分式形式

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image460.png) | (4-3-5) |
|---|---|---------|

相应的单位脉冲响应是

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image461.png) | (4-3-6) |
|---|---|---------|

式中 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image462.png)是单位阶跃响应；根据脉冲响应不变变换法的意义，数字滤波器的单位取样响应是

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image463.png)  | (4-3-7) |
|---|---|---------|

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)的变换即为数字滤波器的系统函数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image465.png)  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image466.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image467.png)| (4-3-8) |
|---|---|---------|

将上式与(4-3-5)式相比，利用下面的关系

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image468.png)  | (4-3-9) |
|---|---|---------|

可以得到 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)至 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)间的变换关系为：

1.![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)与 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)的各部分分式的系数相同，均为 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image470.png)；
2.极点以 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image471.png)的关系进行映射， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)的极点 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image472.png)变成了 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)的 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image471.png)的极点；
3.![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)与 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)间的零点没有一一对应的关系，一般说来，它是由极点和各系数 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image470.png)决定的一个函数关系。

③Python实现案例

利用脉冲响应不变变换法，把下列模拟域的模拟滤波器转换为数字滤波器，采样周期 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image473.png)

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image474.png)  | (4-3-10)  |
|---|---|-----------|

[IIR脉冲响应不变法的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E8%84%89%E5%86%B2%E5%93%8D%E5%BA%94%E4%B8%8D%E5%8F%98%E6%B3%95.ipynb)

④用到的Python函数

1.residue：Compute partial-fraction expansion of b(s) / a(s).

    函数用法：r,p,k = scipy.signal.residue(b, a, tol=0.001, rtype='avg')

输入参数：b是滤波器的分子系数；a是滤波器的分母系数（若a[0]不为1，则会将分子分母用a[0]进行归一化）；tol是两根被认为相等前的距离容差，默认为0.001；rtype是当多个根之间距离小于容差tol时，最后呈现的方式，默认为avg，即各个根取平均。

输出参数：r是对应极点的余数；p是按大小升序排列的极点；k是系数。

2.invresz：Compute b(z) and a(z) from partial fraction expansion.

函数用法：b,a = scipy.signal.invresz(r, p, k, tol=0.001, rtype='avg')

输入参数：r是对应极点的余数；p是极点，相等的极点必须相邻；k是系数；tol是两根被认为相等前的距离容差，默认为0.001；rtype是当多个根之间距离小于容差tol时，最后呈现的方式，默认为avg，。

输出参数：b是数字滤波器的分子系数；a是数字滤波器的分母系数。

##### 双线性变换法

①变换原理

为了克服脉冲响应不变变换法可能产生的频谱混叠效应的缺点，凯塞 (Kaiser) 和戈尔登 (Golden) 建议用一种新的有效的变换，这就是双线性变换。双线性变换可认为是基于对微分方程的积分，利用对积分的数值逼近得到的。

②变换过程

研究一阶微分方程描述的系统

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image475.png) | (4-3-12) |
|---|---|----------|

对上式取拉氏变换即得模拟系统函数

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image476.png)  | (4-3-13) |
|---|---|----------|

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image477.png)可以写成 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image478.png)的积分

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image479.png)  | (4-3-14) |
|---|---|----------|

以取样形式表示，令 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image480.png), ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image481.png)可得到

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image482.png) | (4-3-15) |
|---|---|----------|

用梯形近似求定积分，则上式逼近为

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image483.png) | (4-3-16) |
|---|---|----------|

或写作

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image484.png) | (4-3-17) |
|---|---|----------|

式中微商由(4-3-12)式取样得到，即

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image485.png)  | (4-3-18) |
|---|---|----------|

利用上式可得

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image486.png)

(4-3-19)

式中

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image487.png)  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image488.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image489.png) ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image490.png) | (4-3-20) |
|---|---|----------|

对上式取Z变换，并解得 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)为

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image491.png) | (4-3-21) |
|---|---|----------|

比较 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)和 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)的表达式可见， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)可由 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)作下述的变量代换而得到

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image492.png)  | (4-3-22) |
|---|---|----------|

由上式可得

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image493.png)  | (4-3-23) |
|---|---|----------|

可以得到， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image469.png)至 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)间的变换关系为：

1.把原模拟系统函数分解成并联或级联子系统函数；
2.再对每个子系统函数分别加以双线性变换，公式如下

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image494.png)  | (4-3-24) |
|---|---|----------|

这样就得到了S平面与Z平面的双线性变换关系。它所以叫做“双线性”变换，仅仅是指变换公式中S与Z的关系无论是分子部分，还是分母部分都是“线性”而言。上述结果显然是由一阶系统得出的，但它对高阶系统也照样成立，因为N阶微分方程可以写成N个一阶微分方程。

③Python实现案例

利用双线性变换法，把下列模拟域的模拟滤波器转换为数字滤波器，采样周期 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image495.png)

|   |   ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image474.png) | (4-3-25)  |
|---|---|-----------|

[IIR双线性变换法的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/IIR_%E5%8F%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E6%B3%95.ipynb)

④用到的Python函数

bilinear：Return a digital IIR filter from an analog one using a bilinear transform.

函数用法：z,p = scipy.signal.bilinear(b, a, fs=1.0)

输入参数：b是模拟滤波器的分子系数；a是模拟滤波器的分母系数（若a[0]不为1，则会将分子分母用a[0]进行归一化）；fs是滤波器得采样频率，默认值为1.0。

输出参数：z是数字滤波器的分子系数；p是数字滤波器的分母系数。

### FIR数字滤波器设计

FIR滤波器的单位脉冲响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)仅含有有限个（N个）非零值，是因果的有限长序列。该序列 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)的Z变换为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image496.png)  | (4-3-27) |
|---|---|----------|

 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)是 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image080.png)的 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image497.png)阶多项式。因此， ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)有N-1个零点可位于有限Z平面的任何位置，它还有N-1个位于Z=0处的极点。频率响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)是一个三角多项式

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image499.png)  | (4-3-28) |
|---|---|----------|

因此FIR滤波器的设计问题，实际上就是求频率响应 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)的N个点处的取样值 ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image500.png)（因为任一有限长序列完全由它的傅氏变换的个取样值确定）或N个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)。根据滤波器的线性相位特性，需要选择合适的FIR滤波器类型。

FIR滤波器经常使用的设计方法是窗函数法和频率取样法，需要通过计算机辅助设计来完成。

#### 1 窗函数设计法

①变换原理

窗函数设计法也称傅里叶级数法，出发点是从时域开始，用窗函数截取理想的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)得![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)，以有限长![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)近似理想的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)，这样得到的频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)，逼近于理想的频响![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)，完成FIR数字滤波器的设计

理想滤波器的频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)和单位取样相应序列![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image503.png)为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image504.png)  | (4-3-29) |
|---|---|----------|

|   |![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image505.png)   | (4-3-30) |
|---|---|----------|

一般来说，理想的选频滤波器的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)是逐段恒定的，且在频带边界处有不连续点，因此序列![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)是无限长的，这时不能用(4-3-29)式中傅氏级数系数来设计滤波器，因为第一，滤波器的单位取样响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)是无限长的，n从![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image506.png)无法求和；第二由于![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)是从![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image507.png)开始，所以是非因果的，且不能用有限时延来实现它。

为解决上述问题，可采取如下办法：

1.用有限项和来逼近无限项和。由傅里叶级数理论可知，(4-3-29)式级数的有限部分和![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image508.png)是![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)在均方意义下的最优逼近。这时用到的单位脉冲响应显然是![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image501.png)的一段，是有限长。

2.将有限长的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image509.png)进行![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image510.png)的有限延时，从而由非因果系统得到了因果的系统。幅频特性完全不被时延所影响。因为时域的时延，在频域相应于线性相移，往往可以不考虑。

这种直接截取无限长序列以得到有限长序列的办法，可以形象地想象为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)好比通过一个“窗口”所看到的一段![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image509.png)。因此![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)也可以表达为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image509.png)和一个窗函数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image511.png)的乘积，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image512.png)。这里窗函数就是矩形序列![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image513.png)。

②变换步骤

1）给定所需滤波器性能要求。即给定理想低通或高通滤波器的通带、阻带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image514.png)（或理想带通或带阻滤波器的通带、阻带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image515.png)），通带最大衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image516.png)和阻带最小衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image517.png)；

2）对低通滤波器及高通滤波器，截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image518.png)应选为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image519.png)  | (4-3-31) |
|---|---|----------|

对带通滤波器及带阻滤波器，上下截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image520.png)应选为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image521.png)，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image522.png) | (4-3-32) |
|---|----|----------|

3）通带最大衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image516.png)可以由阻带最小衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image517.png)决定，反之亦然。 从图4.3.1可以看出，通带最大衰减为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image523.png) | (4-3-33) |
|---|---|----------|

阻带最小衰减为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image524.png)  | (4-3-34) |
|---|---|----------|

其中![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image525.png)是纹波。例如给定![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image526.png)，可得

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image527.png) | (4-3-35) |
|---|---|----------|

由此可求出![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image528.png)；

![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image529.jpg)

图 4.3.1 加窗函数后的频率响应幅度函数的误差容限以及![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image530.png)及其过渡带宽![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image531.png)

（![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image532.png)为理想频率响应的幅度函数，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image533.png)是肩峰之间的过渡带，等于窗谱主瓣宽度）

3）求

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image534.png)  | (4-3-36) |
|---|---|----------|

4）选择窗函数的类型和长度点数N。根据表4-3-1，窗函数的类型由给定的滤波器阻带最小衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image517.png)确定；窗的长度点数N由滤波器过渡带宽![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image535.png)确定。窗函数类型及点数N确定后，根据4.2.4节，就得到所需窗函数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image536.png)；

表4.3.1六种窗函数基本参数的比较

| 窗函数     | 窗谱性能指标 |             |加窗后滤波器性能指标          |              |                |
|------------|--------------|----------------------|----------|------------------|------------------|
|            | 旁瓣峰值(dB) | 主瓣宽度             | 过渡带宽![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image537.png) | 阻带最小衰减(dB) | 通带边沿衰减(dB) |
| 矩形窗     | -13          |             ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image538.png)         |     ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image539.png)     | 21               | 0.815            |
| 三角形窗   | -25          |            ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image540.png)          |     ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image541.png)     | 25               | 0.503            |
| 汉宁窗     | -31          |          ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image540.png)            |     ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image542.png)     | 44               | 0.055            |
| 海明窗     | -41          |            ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image540.png)          |     ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image543.png)     | 53               | 0.021            |
| 布拉克曼窗 | -57          |            ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image544.png)          |     ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image545.png)     | 74               | 0.00173          |
| 凯泽窗     | -57          |                      |      ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image546.png)    | 80               | 0.000868         |
|      ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image547.png)      |              |                      |          |                  |                  |

5）求![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image548.png) | (4-3-37) |
|---|---|----------|

6）检验![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image549.png)是否满足所给滤波器的性能要求。

③Python实现案例

例1：用窗函数法设计一个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)偶对称的线性相位FIR低通滤波器，给定通带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image550.png)，阻带截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image551.png)，阻带衰减为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image552.png)。

理想低通滤波器的频率响应和单位抽样响应分别为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image553.png)  | (4-3-38) |
|---|---|----------|
|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image554.png)  | (4-3-39) |

为满足线性相位，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image555.png)。

[窗函数法设计FIR低通滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_LPF_%E6%B1%89%E5%AE%81%E7%AA%97.ipynb)

例2：用窗函数法设计一个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)偶对称的线性相位FIR高通滤波器，给定通带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image556.png)，阻带截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image557.png)，阻带衰减为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image558.png)。

理想高通滤波器的频率响应和单位抽样响应分别为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image559.png)  | (4-3-40) |
|---|---|----------|
|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image560.png)  | (4-3-41) |

为满足线性相位，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image555.png)。

[窗函数法设计FIR高通滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_HPF_%E6%B5%B7%E6%98%8E%E7%AA%97.ipynb)

例3：用窗函数法设计一个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)偶对称的线性相位FIR带通滤波器，给定下阻带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image561.png)，上阻带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image562.png)，通带下截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image563.png)，通带上截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image564.png)，阻带最小衰减为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image565.png)，抽样频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image566.png)。

理想带通滤波器的频率响应和单位抽样响应分别为

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image567.png)  | (4-3-42) |
|---|---|----------|
|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image568.png)  | (4-3-43) |

为满足线性相位，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image555.png)。

[窗函数法设计FIR带通滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_BF_%E5%B8%83%E6%8B%89%E5%85%8B%E6%9B%BC%E7%AA%97.ipynb)

例4：用窗函数法设计一个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image464.png)偶对称的线性相位FIR带阻滤波器，给定阻带下截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image569.png)，阻带上截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image570.png)，下通带截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image571.png)，上通带截止频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image572.png)，阻带最小衰减为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image558.png)，抽样频率为![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image573.png)。

理想带阻滤波器的频率响应和单位抽样响应分别为

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image574.png) | (4-3-44) |
|---|---|----------|
|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image575.png)  | (4-3-45) |

为满足线性相位，![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image555.png)。

[窗函数法设计FIR带阻滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_BSF_%E6%B5%B7%E6%98%8E%E7%AA%97.ipynb)

#### 2 频率取样设计法

①变换原理

频率取样设计法从频域出发。首先给定一个希望逼近的频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)，此处讨论的是线性相位的频率响应。设计是将![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)在的一个周期![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image576.png)内进行N点等间隔取样，即

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image577.png)  | (4-3-46) |
|---|---|----------|

令![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image578.png)作为实际FIR滤波器频率响应的抽样值![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image579.png)，即

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image580.png)  | (4-3-47) |
|---|---|----------|

由DFT定义，有限长序列可用其离散傅里叶变换来唯一确定，即

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image581.png) | (4-3-48) |
|---|---|----------|

根据频域抽样理论的内插公式

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image582.png) | (4-3-49) |
|---|---|----------|
|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image583.png) | (4-3-50) |

利用以上的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image579.png)同样可求得FIR滤波器的系统函数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)以及频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)，这个![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)将逼近所需求的![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)，即有

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image584.png) | (4-3-51) |
|---|---|----------|
|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image585.png)  | (4-3-52) |

其中

|   |  ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image586.png) | (4-3-53) |
|---|---|----------|

将上式带入式(4-3-52)中可得

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image587.png)  | (4-3-54) |
|---|---|----------|

其中![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image498.png)就是设计出的实际FIR数字滤波器的频率响应。

②变换步骤

1）对理想的频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)进行N点等间隔采样得到![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image588.png)，令![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image589.png)；

2）对第一大类线性相位FIR滤波器[![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image453.png)偶对称，
![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image590.png)]，当N为奇数时，有

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image591.png)  | (4-3-55) |
|---|---|----------|

当N为偶数时，有

|   | ![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image592.png)  | (4-3-56) |
|---|---|----------|

3）利用![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image579.png)序列通过IDFT求出FIR滤波器的系统函数![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image092.png)及频率响应![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image502.png)，同样还可求出有限长序列![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image593.png)；

4）检验设计出的滤波器阻带衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image526.png)是否满足要求，若不满足，则要调整过渡带抽样点上![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image594.png)值的大小，或增加过渡带抽样点数；若边沿频率不满足要求，则要增加整个抽样点数N来加以调整。

③Python实现案例

例：使用第一种频率抽样法设计一个线性相位低通滤波器，要求通带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image595.png)，阻带截止频率![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image596.png)，阻带最小衰减![image](https://github.com/mmaayybelin/signal-processing_python/blob/main/images/dsp_python/image552.png)。

[频率采样法设计FIR滤波器的Python实现](https://github.com/mmaayybelin/signal-processing_python/blob/main/Code/dsp_python/FIR_%E9%A2%91%E7%8E%87%E9%87%87%E6%A0%B7%E6%B3%95.ipynb)
